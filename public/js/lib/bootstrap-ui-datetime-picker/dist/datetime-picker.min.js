// https://github.com/Gillardo/bootstrap-ui-datetime-picker
// Version: 2.1.0
// Released: 2016-01-18 
angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("uiDatetimePickerConfig",{dateFormat:"yyyy-MM-dd HH:mm",defaultTime:"00:00:00",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},enableDate:!0,enableTime:!0,todayText:"Today",nowText:"Now",clearText:"Clear",closeText:"Done",dateText:"Date",timeText:"Time",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0,altInputFormats:[],ngModelOptions:{}}).controller("DateTimePickerController",["$scope","$element","$attrs","$compile","$parse","$document","$timeout","$uibPosition","dateFilter","uibDateParser","uiDatetimePickerConfig","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(c){var d=u[0],e=b[0].contains(c.target),f=void 0!==d.contains&&d.contains(c.target);!a.isOpen||e||f||a.$apply(function(){a.isOpen=!1})}function n(c){27===c.which&&a.isOpen?(c.preventDefault(),c.stopPropagation(),a.$apply(function(){a.close()}),b[0].focus()):40!==c.which||a.isOpen||(c.preventDefault(),c.stopPropagation(),a.$apply(function(){a.isOpen=!0}))}function o(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function p(b){var c=j.parse(b,v,a.date);if(isNaN(c))for(var d=0;d<z.length;d++)if(c=j.parse(b,z[d],a.date),!isNaN(c))return c;return c}function q(a){angular.isNumber(a)&&(a=new Date(a));{if(!a)return null;if(angular.isDate(a)&&!isNaN(a))return a;if(angular.isString(a)){var b=p(a);if(!isNaN(b))return j.toTimezone(b,t.timezone);return}}}function r(a,b){var d=a||b;return c.ngRequired||c.required||d?(angular.isNumber(d)&&(d=new Date(d)),d?angular.isDate(d)&&!isNaN(d)?!0:angular.isDate(new Date(d))&&!isNaN(new Date(d).valueOf())?!0:angular.isString(d)?!isNaN(p(b)):!1:!0):!0}var s,t,u,v=k.dateFormat,w=[],x=angular.isDefined(c.closeOnDateSelection)?a.$parent.$eval(c.closeOnDateSelection):k.closeOnDateSelection,y=angular.isDefined(c.datepickerAppendToBody)?a.$parent.$eval(c.datepickerAppendToBody):k.appendToBody,z=angular.isDefined(c.altInputFormats)?a.$parent.$eval(c.altInputFormats):k.altInputFormats;this.init=function(g){s=g,t=s.$options||k.ngModelOptions,a.watchData={},a.showButtonBar=angular.isDefined(c.showButtonBar)?a.$parent.$eval(c.showButtonBar):k.showButtonBar,a.enableDate=angular.isDefined(a.enableDate)?a.enableDate:k.enableDate,a.enableTime=angular.isDefined(a.enableTime)?a.enableTime:k.enableTime,a.showPicker=a.enableDate?"date":"time";var h=!1;k.html5Types[c.type]?(v=k.html5Types[c.type],h=!0):(v=c.datepickerPopup||k.dateFormat,c.$observe("datetimePicker",function(a){var b=a||k.dateFormat;if(b!==v&&(v=b,s.$modelValue=null,!v))throw new Error("datetimePicker must have a date format specified.")}));var l=angular.element('<div date-picker-wrap><div uib-datepicker></div></div><div time-picker-wrap><div uib-timepicker style="margin:0 auto"></div></div>');a.ngModelOptions=angular.copy(t),a.ngModelOptions.timezone=null,l.attr({"ng-model":"date","ng-model-options":"ngModelOptions","ng-change":"dateSelection(date)"});var m=angular.element(l.children()[0]);if(h&&"month"===c.type&&(m.attr("datepicker-mode",'"month"'),m.attr("min-mode","month")),c.datepickerOptions){var x=a.$parent.$eval(c.datepickerOptions);x&&x.initDate&&(a.initDate=dateParser.fromTimezone(x.initDate,t.timezone),m.attr("init-date","initDate"),delete x.initDate),angular.forEach(x,function(a,b){m.attr(o(b),a)})}angular.isDefined(c.datepickerMode)||(c.datepickerMode="day"),c.dateDisabled&&m.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","showWeeks","startingDay","yearRows","yearColumns"],function(a){angular.isDefined(c[a])&&m.attr(o(a),c[a])}),c.customClass&&m.attr("custom-class","customClass({ date: date, mode: mode })"),angular.forEach(["minMode","maxMode","datepickerMode","shortcutPropagation"],function(b){if(c[b]){var d=e(c[b]);if(w.push(a.$parent.$watch(d,function(c){a.watchData[b]=c})),m.attr(o(b),"watchData."+b),"datepickerMode"===b){var f=d.assign;w.push(a.$watch("watchData."+b,function(b,c){angular.isFunction(f)&&b!==c&&f(a.$parent,b)}))}}});var z=angular.element(l.children()[1]);if(c.timepickerOptions){var x=a.$parent.$eval(c.timepickerOptions);angular.forEach(x,function(b,c){a.watchData[c]=b,z.attr(o(c),"watchData."+c)})}angular.forEach(["minDate","maxDate","initDate"],function(b){if(c[b]){var d=e(c[b]);w.push(a.$parent.$watch(d,function(c){a.watchData[b]=c})),m.attr(o(b),"watchData."+b),"minDate"==b?z.attr("min","watchData.minDate"):"maxDate"==b&&z.attr("max","watchData.maxDate")}}),h?s.$formatters.push(function(b){return a.date=j.fromTimezone(b,t.timezone),b}):(s.$$parserName="datetime",s.$validators.datetime=r,s.$parsers.unshift(q),s.$formatters.push(function(b){return s.$isEmpty(b)?(a.date=b,b):(a.date=j.fromTimezone(b,t.timezone),v=v.replace(/M!/,"MM").replace(/d!/,"dd"),i(a.date,v))})),s.$viewChangeListeners.push(function(){a.date=p(s.$viewValue)}),b.bind("keydown",n),u=d(l)(a),l.remove(),y?f.find("body").append(u):b.after(u)},a.getText=function(b){return a[b+"Text"]||k[b+"Text"]},a.dateSelection=function(d){if(a.enableTime&&"time"===a.showPicker&&(d||null!=d)&&(angular.isDefined(a.date)&&null!=a.date||(a.date=new Date),d&&null!=d)){var e=new Date(a.date);e.setHours(d.getHours()),e.setMinutes(d.getMinutes()),e.setSeconds(d.getSeconds()),e.setMilliseconds(d.getMilliseconds()),d=e}if(angular.isDefined(d)){if(!a.date){var f=angular.isDefined(c.defaultTime)?c.defaultTime:k.defaultTime,h=new Date("2001-01-01 "+f);isNaN(h)||(d.setHours(h.getHours()),d.setMinutes(h.getMinutes()),d.setSeconds(h.getSeconds()),d.setMilliseconds(h.getMilliseconds()))}a.date=d}var e=a.date?i(a.date,v,t.timezone):null;b.val(e),s.$setViewValue(e),x&&"time"!=a.showPicker&&null!=e&&(a.enableTime?g(function(){a.showPicker="time"},0):a.close())},a.keydown=function(c){27===c.which&&(a.close(),b[0].focus())},a.$watch("isOpen",function(c){if(a.dropdownStyle={display:c?"block":"none"},c){var d=y?h.offset(b):h.position(b);y?a.dropdownStyle.top=d.top+b.prop("offsetHeight")+"px":a.dropdownStyle.top=void 0,a.dropdownStyle.left=d.left+"px",g(function(){a.$broadcast("uib:datepicker.focus"),f.bind("click",m)},0,!1)}else f.unbind("click",m)}),a.isDisabled=function(b){return("today"===b||"now"===b)&&(b=new Date),a.watchData.minDate&&a.compare(b,a.watchData.minDate)<0||a.watchData.maxDate&&a.compare(b,a.watchData.maxDate)>0},a.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},a.select=function(b){var c=null;if("today"===b||"now"==b){var d=new Date;angular.isDate(a.date)?(c=new Date(a.date),c.setFullYear(d.getFullYear(),d.getMonth(),d.getDate()),c.setHours(d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds())):c=d}a.dateSelection(c),"clear"==b&&a.close()},a.close=function(){a.isOpen=!1,a.enableDate&&a.enableTime&&(a.showPicker="date"),b[0].focus()},a.changePicker=function(b,c){b.preventDefault(),b.stopPropagation(),a.showPicker=c},a.$on("$destroy",function(){a.isOpen===!0&&(l.$$phase||a.$apply(function(){a.close()})),w.forEach(function(a){a()}),u.remove(),b.unbind("keydown",n),f.unbind("click",m)})}]).directive("datetimePicker",function(){return{restrict:"A",require:["ngModel","datetimePicker"],controller:"DateTimePickerController",scope:{isOpen:"=?",enableDate:"=?",enableTime:"=?",todayText:"@",nowText:"@",dateText:"@",timeText:"@",clearText:"@",closeText:"@",dateDisabled:"&",customClass:"&"},link:function(a,b,c,d){var e=d[0],f=d[1];f.init(e)}}}).directive("datePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/date-picker.html"}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/time-picker.html"}}),angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(a){"use strict";a.put("template/date-picker.html",'<ul ng-if="isOpen && showPicker == \'date\'" class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click=$event.stopPropagation()><li style="padding:0 5px 5px 5px" class=date-picker-menu><div ng-transclude></div></li><li ng-if=showButtonBar style=padding:5px><span class="btn-group pull-left" style=margin-right:10px><button type=button class="btn btn-sm btn-info" ng-click="select(\'today\')" ng-disabled="isDisabled(\'today\')">{{ getText(\'today\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-click="select(\'clear\')">{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right"><button ng-if=enableTime type=button class="btn btn-sm btn-default" ng-click="changePicker($event, \'time\')">{{ getText(\'time\')}}</button> <button type=button class="btn btn-sm btn-success" ng-click=close()>{{ getText(\'close\') }}</button></span></li></ul>'),a.put("template/time-picker.html",'<ul ng-if="isOpen && showPicker == \'time\'" class="dropdown-menu dropdown-menu-left datetime-picker-dropdown" ng-style=dropdownStyle style=left:inherit ng-keydown=keydown($event) ng-click=$event.stopPropagation()><li style="padding:0 5px 5px 5px" class=time-picker-menu><div ng-transclude></div></li><li ng-if=showButtonBar style=padding:5px><span class="btn-group pull-left" style=margin-right:10px><button type=button class="btn btn-sm btn-info" ng-click="select(\'now\')" ng-disabled="isDisabled(\'now\')">{{ getText(\'now\') }}</button> <button type=button class="btn btn-sm btn-danger" ng-click="select(\'clear\')">{{ getText(\'clear\') }}</button></span> <span class="btn-group pull-right"><button ng-if=enableDate type=button class="btn btn-sm btn-default" ng-click="changePicker($event, \'date\')">{{ getText(\'date\')}}</button> <button type=button class="btn btn-sm btn-success" ng-click=close()>{{ getText(\'close\') }}</button></span></li></ul>')}]);